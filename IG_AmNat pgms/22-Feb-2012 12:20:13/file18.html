<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Function details for fminsearch</title><link rel="stylesheet" href="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">fminsearch (8004 calls, 66.468 sec)</span><br/><i>Generated 22-Feb-2012 12:20:15 using cpu time.</i><br/>function in file /ibrix/packages/MATLAB/R2011b/toolbox/matlab/funfun/fminsearch.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file3.html">IG_AmNat</a></td><td class="td-linebottomrt">script</td><td class="td-linebottomrt">4</td></tr><tr><td class="td-linebottomrt"><a href="file23.html">parallel_function</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">8000</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line362">362</a></td><td class="td-linebottomrt"><pre>x(:) = v(:,j); fv(:,j) = funfc...</pre></td><td class="td-linebottomrt">144064</td><td class="td-linebottomrt">22.437 s</td><td class="td-linebottomrt" class="td-linebottomrt">33.8%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=34 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line306">306</a></td><td class="td-linebottomrt"><pre>x(:) = xr; fxr = funfcn(x,vara...</pre></td><td class="td-linebottomrt">72032</td><td class="td-linebottomrt">11.132 s</td><td class="td-linebottomrt" class="td-linebottomrt">16.7%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=17 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line347">347</a></td><td class="td-linebottomrt"><pre>x(:) = xcc; fxcc = funfcn(x,va...</pre></td><td class="td-linebottomrt">72032</td><td class="td-linebottomrt">10.964 s</td><td class="td-linebottomrt" class="td-linebottomrt">16.5%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=16 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line251">251</a></td><td class="td-linebottomrt"><pre>x(:) = y; f = funfcn(x,varargi...</pre></td><td class="td-linebottomrt">16008</td><td class="td-linebottomrt">2.437 s</td><td class="td-linebottomrt" class="td-linebottomrt">3.7%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=4 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line304">304</a></td><td class="td-linebottomrt"><pre>xbar = sum(v(:,one2n), 2)/n;</pre></td><td class="td-linebottomrt">72032</td><td class="td-linebottomrt">1.864 s</td><td class="td-linebottomrt" class="td-linebottomrt">2.8%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=3 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">17.634 s</td><td class="td-linebottomrt">26.5%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=27 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">66.468 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file22.html">IGfunct</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">312140</td><td class="td-linebottomrt">43.443 s</td><td class="td-linebottomrt">65.4%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=65 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file16.html">optimget</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">64032</td><td class="td-linebottomrt">3.430 s</td><td class="td-linebottomrt">5.2%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=5 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file19.html">fcnchk</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">8004</td><td class="td-linebottomrt">1.301 s</td><td class="td-linebottomrt">2.0%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=2 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">18.294 s</td><td class="td-linebottomrt">27.5%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=28 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">66.468 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>Code Analyzer results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line174">174</a></td><td class="td-linebottomrt"><span class="mono">{ A{:} B } can often be replaced by [ A {B}], which can be much faster.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line222">222</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (in functions).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line223">223</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (in functions).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line224">224</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (in functions).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line267">267</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (in functions).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line268">268</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (in functions).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line269">269</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (in functions).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line283">283</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'exitflag' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line376">376</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (in functions).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line377">377</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (in functions).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line378">378</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (in functions).</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>[ Show coverage for parent directory ]<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">441</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">162</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">279</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">119</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">160</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">42.65 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/>               <span style="color: #A0A0A0">   1</span> <span style="color: #A0A0A0; background: #FFFFFF;">function [x,fval,exitflag,output] = fminsearch(funfcn,x,options,varargin)</span><br/>               <span style="color: #A0A0A0">   2</span> <span style="color: #228B22; background: #FFFFFF;">%FMINSEARCH Multidimensional unconstrained nonlinear minimization (Nelder-Mead).</span><br/>               <span style="color: #A0A0A0">   3</span> <span style="color: #228B22; background: #FFFFFF;">%   X = FMINSEARCH(FUN,X0) starts at X0 and attempts to find a local minimizer </span><br/>               <span style="color: #A0A0A0">   4</span> <span style="color: #228B22; background: #FFFFFF;">%   X of the function FUN.  FUN is a function handle.  FUN accepts input X and </span><br/>               <span style="color: #A0A0A0">   5</span> <span style="color: #228B22; background: #FFFFFF;">%   returns a scalar function value F evaluated at X. X0 can be a scalar, vector </span><br/>               <span style="color: #A0A0A0">   6</span> <span style="color: #228B22; background: #FFFFFF;">%   or matrix.</span><br/>               <span style="color: #A0A0A0">   7</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">   8</span> <span style="color: #228B22; background: #FFFFFF;">%   X = FMINSEARCH(FUN,X0,OPTIONS)  minimizes with the default optimization</span><br/>               <span style="color: #A0A0A0">   9</span> <span style="color: #228B22; background: #FFFFFF;">%   parameters replaced by values in the structure OPTIONS, created</span><br/>               <span style="color: #A0A0A0">  10</span> <span style="color: #228B22; background: #FFFFFF;">%   with the OPTIMSET function.  See OPTIMSET for details.  FMINSEARCH uses</span><br/>               <span style="color: #A0A0A0">  11</span> <span style="color: #228B22; background: #FFFFFF;">%   these options: Display, TolX, TolFun, MaxFunEvals, MaxIter, FunValCheck,</span><br/>               <span style="color: #A0A0A0">  12</span> <span style="color: #228B22; background: #FFFFFF;">%   PlotFcns, and OutputFcn.</span><br/>               <span style="color: #A0A0A0">  13</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  14</span> <span style="color: #228B22; background: #FFFFFF;">%   X = FMINSEARCH(PROBLEM) finds the minimum for PROBLEM. PROBLEM is a</span><br/>               <span style="color: #A0A0A0">  15</span> <span style="color: #228B22; background: #FFFFFF;">%   structure with the function FUN in PROBLEM.objective, the start point</span><br/>               <span style="color: #A0A0A0">  16</span> <span style="color: #228B22; background: #FFFFFF;">%   in PROBLEM.x0, the options structure in PROBLEM.options, and solver</span><br/>               <span style="color: #A0A0A0">  17</span> <span style="color: #228B22; background: #FFFFFF;">%   name 'fminsearch' in PROBLEM.solver. The PROBLEM structure must have</span><br/>               <span style="color: #A0A0A0">  18</span> <span style="color: #228B22; background: #FFFFFF;">%   all the fields.</span><br/>               <span style="color: #A0A0A0">  19</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  20</span> <span style="color: #228B22; background: #FFFFFF;">%   [X,FVAL]= FMINSEARCH(...) returns the value of the objective function,</span><br/>               <span style="color: #A0A0A0">  21</span> <span style="color: #228B22; background: #FFFFFF;">%   described in FUN, at X.</span><br/>               <span style="color: #A0A0A0">  22</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  23</span> <span style="color: #228B22; background: #FFFFFF;">%   [X,FVAL,EXITFLAG] = FMINSEARCH(...) returns an EXITFLAG that describes </span><br/>               <span style="color: #A0A0A0">  24</span> <span style="color: #228B22; background: #FFFFFF;">%   the exit condition of FMINSEARCH. Possible values of EXITFLAG and the </span><br/>               <span style="color: #A0A0A0">  25</span> <span style="color: #228B22; background: #FFFFFF;">%   corresponding exit conditions are</span><br/>               <span style="color: #A0A0A0">  26</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  27</span> <span style="color: #228B22; background: #FFFFFF;">%    1  Maximum coordinate difference between current best point and other</span><br/>               <span style="color: #A0A0A0">  28</span> <span style="color: #228B22; background: #FFFFFF;">%       points in simplex is less than or equal to TolX, and corresponding </span><br/>               <span style="color: #A0A0A0">  29</span> <span style="color: #228B22; background: #FFFFFF;">%       difference in function values is less than or equal to TolFun.</span><br/>               <span style="color: #A0A0A0">  30</span> <span style="color: #228B22; background: #FFFFFF;">%    0  Maximum number of function evaluations or iterations reached.</span><br/>               <span style="color: #A0A0A0">  31</span> <span style="color: #228B22; background: #FFFFFF;">%   -1  Algorithm terminated by the output function.</span><br/>               <span style="color: #A0A0A0">  32</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  33</span> <span style="color: #228B22; background: #FFFFFF;">%   [X,FVAL,EXITFLAG,OUTPUT] = FMINSEARCH(...) returns a structure</span><br/>               <span style="color: #A0A0A0">  34</span> <span style="color: #228B22; background: #FFFFFF;">%   OUTPUT with the number of iterations taken in OUTPUT.iterations, the</span><br/>               <span style="color: #A0A0A0">  35</span> <span style="color: #228B22; background: #FFFFFF;">%   number of function evaluations in OUTPUT.funcCount, the algorithm name </span><br/>               <span style="color: #A0A0A0">  36</span> <span style="color: #228B22; background: #FFFFFF;">%   in OUTPUT.algorithm, and the exit message in OUTPUT.message.</span><br/>               <span style="color: #A0A0A0">  37</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  38</span> <span style="color: #228B22; background: #FFFFFF;">%   Examples</span><br/>               <span style="color: #A0A0A0">  39</span> <span style="color: #228B22; background: #FFFFFF;">%     FUN can be specified using @:</span><br/>               <span style="color: #A0A0A0">  40</span> <span style="color: #228B22; background: #FFFFFF;">%        X = fminsearch(@sin,3)</span><br/>               <span style="color: #A0A0A0">  41</span> <span style="color: #228B22; background: #FFFFFF;">%     finds a minimum of the SIN function near 3.</span><br/>               <span style="color: #A0A0A0">  42</span> <span style="color: #228B22; background: #FFFFFF;">%     In this case, SIN is a function that returns a scalar function value</span><br/>               <span style="color: #A0A0A0">  43</span> <span style="color: #228B22; background: #FFFFFF;">%     SIN evaluated at X.</span><br/>               <span style="color: #A0A0A0">  44</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  45</span> <span style="color: #228B22; background: #FFFFFF;">%     FUN can be an anonymous function:</span><br/>               <span style="color: #A0A0A0">  46</span> <span style="color: #228B22; background: #FFFFFF;">%        X = fminsearch(@(x) norm(x),[1;2;3])</span><br/>               <span style="color: #A0A0A0">  47</span> <span style="color: #228B22; background: #FFFFFF;">%     returns a point near the minimizer [0;0;0].</span><br/>               <span style="color: #A0A0A0">  48</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  49</span> <span style="color: #228B22; background: #FFFFFF;">%     FUN can be a parameterized function. Use an anonymous function to</span><br/>               <span style="color: #A0A0A0">  50</span> <span style="color: #228B22; background: #FFFFFF;">%     capture the problem-dependent parameters:</span><br/>               <span style="color: #A0A0A0">  51</span> <span style="color: #228B22; background: #FFFFFF;">%        f = @(x,c) x(1).^2+c.*x(2).^2;  % The parameterized function.</span><br/>               <span style="color: #A0A0A0">  52</span> <span style="color: #228B22; background: #FFFFFF;">%        c = 1.5;                        % The parameter.</span><br/>               <span style="color: #A0A0A0">  53</span> <span style="color: #228B22; background: #FFFFFF;">%        X = fminsearch(@(x) f(x,c),[0.3;1])</span><br/>               <span style="color: #A0A0A0">  54</span> <span style="color: #228B22; background: #FFFFFF;">%        </span><br/>               <span style="color: #A0A0A0">  55</span> <span style="color: #228B22; background: #FFFFFF;">%   FMINSEARCH uses the Nelder-Mead simplex (direct search) method.</span><br/>               <span style="color: #A0A0A0">  56</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  57</span> <span style="color: #228B22; background: #FFFFFF;">%   See also OPTIMSET, FMINBND, FUNCTION_HANDLE.</span><br/>               <span style="color: #A0A0A0">  58</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  59</span> <span style="color: #228B22; background: #FFFFFF;">%   Reference: Jeffrey C. Lagarias, James A. Reeds, Margaret H. Wright,</span><br/>               <span style="color: #A0A0A0">  60</span> <span style="color: #228B22; background: #FFFFFF;">%   Paul E. Wright, "Convergence Properties of the Nelder-Mead Simplex</span><br/>               <span style="color: #A0A0A0">  61</span> <span style="color: #228B22; background: #FFFFFF;">%   Method in Low Dimensions", SIAM Journal of Optimization, 9(1):</span><br/>               <span style="color: #A0A0A0">  62</span> <span style="color: #228B22; background: #FFFFFF;">%   p.112-147, 1998.</span><br/>               <span style="color: #A0A0A0">  63</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  64</span> <span style="color: #228B22; background: #FFFFFF;">%   Copyright 1984-2010 The MathWorks, Inc.</span><br/>               <span style="color: #A0A0A0">  65</span> <span style="color: #228B22; background: #FFFFFF;">%   $Revision: 1.21.4.21 $  $Date: 2010/11/22 02:46:05 $</span><br/>               <span style="color: #A0A0A0">  66</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  67</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.25 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold">  68</span> <span style="color: #000000; background: #FFFFFF;">defaultopt = struct('Display','notify','MaxIter','200*numberOfVariables',... </span><br/>               <span style="color: #A0A0A0">  69</span> <span style="color: #000000; background: #FFFFFF;">    'MaxFunEvals','200*numberOfVariables','TolX',1e-4,'TolFun',1e-4, ...</span><br/>               <span style="color: #A0A0A0">  70</span> <span style="color: #000000; background: #FFFFFF;">    'FunValCheck','off','OutputFcn',[],'PlotFcns',[]);</span><br/>               <span style="color: #A0A0A0">  71</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  72</span> <span style="color: #228B22; background: #FFFFFF;">% If just 'defaults' passed in, return the default options in X</span><br/><span style="color: #FF0000">  0.06 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold">  73</span> <span style="color: #000000; background: #FFFFFF;">if nargin==1 &amp;&amp; nargout &lt;= 1 &amp;&amp; isequal(funfcn,'defaults') </span><br/>               <span style="color: #A0A0A0">  74</span> <span style="color: #A0A0A0; background: #FFFFFF;">    x = defaultopt;</span><br/>               <span style="color: #A0A0A0">  75</span> <span style="color: #A0A0A0; background: #FFFFFF;">    return</span><br/>               <span style="color: #A0A0A0">  76</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0">  77</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold">  78</span> <span style="color: #000000; background: #FFFFFF;">if nargin&lt;3, options = []; end </span><br/>               <span style="color: #A0A0A0">  79</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  80</span> <span style="color: #228B22; background: #FFFFFF;">% Detect problem structure input</span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold">  81</span> <span style="color: #000000; background: #FFFFFF;">if nargin == 1 </span><br/>               <span style="color: #A0A0A0">  82</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if isa(funfcn,'struct') </span><br/>               <span style="color: #A0A0A0">  83</span> <span style="color: #A0A0A0; background: #FFFFFF;">        [funfcn,x,options] = separateOptimStruct(funfcn);</span><br/>               <span style="color: #A0A0A0">  84</span> <span style="color: #228B22; background: #FFFFFF;">    else % Single input and non-structure</span><br/>               <span style="color: #A0A0A0">  85</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error(message('MATLAB:fminsearch:InputArg'));</span><br/>               <span style="color: #A0A0A0">  86</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0">  87</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0">  88</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold">  89</span> <span style="color: #000000; background: #FFFFFF;">if nargin == 0 </span><br/>               <span style="color: #A0A0A0">  90</span> <span style="color: #A0A0A0; background: #FFFFFF;">    error(message('MATLAB:fminsearch:NotEnoughInputs'));</span><br/>               <span style="color: #A0A0A0">  91</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0">  92</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  93</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  94</span> <span style="color: #228B22; background: #FFFFFF;">% Check for non-double inputs</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold">  95</span> <span style="color: #000000; background: #FFFFFF;">if ~isa(x,'double') </span><br/>               <span style="color: #A0A0A0">  96</span> <span style="color: #A0A0A0; background: #FFFFFF;">  error(message('MATLAB:fminsearch:NonDoubleInput'))</span><br/>               <span style="color: #A0A0A0">  97</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0">  98</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold">  99</span> <span style="color: #000000; background: #FFFFFF;">n = numel(x); </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 100</span> <span style="color: #000000; background: #FFFFFF;">numberOfVariables = n; </span><br/>               <span style="color: #A0A0A0"> 101</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.52 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 102</span> <span style="color: #000000; background: #FFFFFF;">printtype = <a href="file16.html">optimget</a>(options,'Display',defaultopt,'fast'); </span><br/><span style="color: #FF0000">  0.47 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 103</span> <span style="color: #000000; background: #FFFFFF;">tolx = <a href="file16.html">optimget</a>(options,'TolX',defaultopt,'fast'); </span><br/><span style="color: #FF0000">  0.47 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 104</span> <span style="color: #000000; background: #FFFFFF;">tolf = <a href="file16.html">optimget</a>(options,'TolFun',defaultopt,'fast'); </span><br/><span style="color: #FF0000">  0.42 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 105</span> <span style="color: #000000; background: #FFFFFF;">maxfun = <a href="file16.html">optimget</a>(options,'MaxFunEvals',defaultopt,'fast'); </span><br/><span style="color: #FF0000">  0.47 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 106</span> <span style="color: #000000; background: #FFFFFF;">maxiter = <a href="file16.html">optimget</a>(options,'MaxIter',defaultopt,'fast'); </span><br/><span style="color: #FF0000">  0.49 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 107</span> <span style="color: #000000; background: #FFFFFF;">funValCheck = strcmp(<a href="file16.html">optimget</a>(options,'FunValCheck',defaultopt,'fast'),'on'); </span><br/>               <span style="color: #A0A0A0"> 108</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 109</span> <span style="color: #228B22; background: #FFFFFF;">% In case the defaults were gathered from calling: optimset('fminsearch'):</span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 110</span> <span style="color: #000000; background: #FFFFFF;">if ischar(maxfun) </span><br/>               <span style="color: #A0A0A0"> 111</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if isequal(lower(maxfun),'200*numberofvariables')</span><br/>               <span style="color: #A0A0A0"> 112</span> <span style="color: #A0A0A0; background: #FFFFFF;">        maxfun = 200*numberOfVariables;</span><br/>               <span style="color: #A0A0A0"> 113</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 114</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error(message('MATLAB:fminsearch:OptMaxFunEvalsNotInteger'))</span><br/>               <span style="color: #A0A0A0"> 115</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 116</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 117</span> <span style="color: #000000; background: #FFFFFF;">if ischar(maxiter) </span><br/><span style="color: #FF0000">  0.06 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 118</span> <span style="color: #000000; background: #FFFFFF;">    if isequal(lower(maxiter),'200*numberofvariables') </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 119</span> <span style="color: #000000; background: #FFFFFF;">        maxiter = 200*numberOfVariables; </span><br/>               <span style="color: #A0A0A0"> 120</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 121</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error(message('MATLAB:fminsearch:OptMaxIterNotInteger'))</span><br/>               <span style="color: #A0A0A0"> 122</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 123</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 124</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 125</span> <span style="color: #000000; background: #FFFFFF;">switch printtype </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 126</span> <span style="color: #000000; background: #FFFFFF;">    case {'notify','notify-detailed'} </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 127</span> <span style="color: #000000; background: #FFFFFF;">        prnt = 1; </span><br/>               <span style="color: #A0A0A0"> 128</span> <span style="color: #A0A0A0; background: #FFFFFF;">    case {'none','off'}</span><br/>               <span style="color: #A0A0A0"> 129</span> <span style="color: #A0A0A0; background: #FFFFFF;">        prnt = 0;</span><br/>               <span style="color: #A0A0A0"> 130</span> <span style="color: #A0A0A0; background: #FFFFFF;">    case {'iter','iter-detailed'}</span><br/>               <span style="color: #A0A0A0"> 131</span> <span style="color: #A0A0A0; background: #FFFFFF;">        prnt = 3;</span><br/>               <span style="color: #A0A0A0"> 132</span> <span style="color: #A0A0A0; background: #FFFFFF;">    case {'final','final-detailed'}</span><br/>               <span style="color: #A0A0A0"> 133</span> <span style="color: #A0A0A0; background: #FFFFFF;">        prnt = 2;</span><br/>               <span style="color: #A0A0A0"> 134</span> <span style="color: #A0A0A0; background: #FFFFFF;">    case 'simplex'</span><br/>               <span style="color: #A0A0A0"> 135</span> <span style="color: #A0A0A0; background: #FFFFFF;">        prnt = 4;</span><br/>               <span style="color: #A0A0A0"> 136</span> <span style="color: #A0A0A0; background: #FFFFFF;">    otherwise</span><br/>               <span style="color: #A0A0A0"> 137</span> <span style="color: #A0A0A0; background: #FFFFFF;">        prnt = 1;</span><br/>               <span style="color: #A0A0A0"> 138</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 139</span> <span style="color: #228B22; background: #FFFFFF;">% Handle the output</span><br/><span style="color: #FF0000">  0.51 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 140</span> <span style="color: #000000; background: #FFFFFF;">outputfcn = <a href="file16.html">optimget</a>(options,'OutputFcn',defaultopt,'fast'); </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 141</span> <span style="color: #000000; background: #FFFFFF;">if isempty(outputfcn) </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 142</span> <span style="color: #000000; background: #FFFFFF;">    haveoutputfcn = false; </span><br/>               <span style="color: #A0A0A0"> 143</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 144</span> <span style="color: #A0A0A0; background: #FFFFFF;">    haveoutputfcn = true;</span><br/>               <span style="color: #A0A0A0"> 145</span> <span style="color: #A0A0A0; background: #FFFFFF;">    xOutputfcn = x; % Last x passed to outputfcn; has the input x's shape</span><br/>               <span style="color: #A0A0A0"> 146</span> <span style="color: #228B22; background: #FFFFFF;">    % Parse OutputFcn which is needed to support cell array syntax for OutputFcn.</span><br/>               <span style="color: #A0A0A0"> 147</span> <span style="color: #A0A0A0; background: #FFFFFF;">    outputfcn = createCellArrayOfFunctions(outputfcn,'OutputFcn');</span><br/>               <span style="color: #A0A0A0"> 148</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 149</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 150</span> <span style="color: #228B22; background: #FFFFFF;">% Handle the plot</span><br/><span style="color: #FF0000">  0.48 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 151</span> <span style="color: #000000; background: #FFFFFF;">plotfcns = <a href="file16.html">optimget</a>(options,'PlotFcns',defaultopt,'fast'); </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 152</span> <span style="color: #000000; background: #FFFFFF;">if isempty(plotfcns) </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 153</span> <span style="color: #000000; background: #FFFFFF;">    haveplotfcn = false; </span><br/>               <span style="color: #A0A0A0"> 154</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 155</span> <span style="color: #A0A0A0; background: #FFFFFF;">    haveplotfcn = true;</span><br/>               <span style="color: #A0A0A0"> 156</span> <span style="color: #A0A0A0; background: #FFFFFF;">    xOutputfcn = x; % Last x passed to plotfcns; has the input x's shape</span><br/>               <span style="color: #A0A0A0"> 157</span> <span style="color: #228B22; background: #FFFFFF;">    % Parse PlotFcns which is needed to support cell array syntax for PlotFcns.</span><br/>               <span style="color: #A0A0A0"> 158</span> <span style="color: #A0A0A0; background: #FFFFFF;">    plotfcns = createCellArrayOfFunctions(plotfcns,'PlotFcns');</span><br/>               <span style="color: #A0A0A0"> 159</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 160</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 161</span> <span style="color: #000000; background: #FFFFFF;">header = ' Iteration   Func-count     min f(x)         Procedure'; </span><br/>               <span style="color: #A0A0A0"> 162</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 163</span> <span style="color: #228B22; background: #FFFFFF;">% Convert to function handle as needed.</span><br/><span style="color: #FF0000">  1.39 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 164</span> <span style="color: #000000; background: #FFFFFF;">funfcn = <a href="file19.html">fcnchk</a>(funfcn,length(varargin)); </span><br/>               <span style="color: #A0A0A0"> 165</span> <span style="color: #228B22; background: #FFFFFF;">% Add a wrapper function to check for Inf/NaN/complex values</span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 166</span> <span style="color: #000000; background: #FFFFFF;">if funValCheck </span><br/>               <span style="color: #A0A0A0"> 167</span> <span style="color: #228B22; background: #FFFFFF;">    % Add a wrapper function, CHECKFUN, to check for NaN/complex values without</span><br/>               <span style="color: #A0A0A0"> 168</span> <span style="color: #228B22; background: #FFFFFF;">    % having to change the calls that look like this:</span><br/>               <span style="color: #A0A0A0"> 169</span> <span style="color: #228B22; background: #FFFFFF;">    % f = funfcn(x,varargin{:});</span><br/>               <span style="color: #A0A0A0"> 170</span> <span style="color: #228B22; background: #FFFFFF;">    % x is the first argument to CHECKFUN, then the user's function,</span><br/>               <span style="color: #A0A0A0"> 171</span> <span style="color: #228B22; background: #FFFFFF;">    % then the elements of varargin. To accomplish this we need to add the </span><br/>               <span style="color: #A0A0A0"> 172</span> <span style="color: #228B22; background: #FFFFFF;">    % user's function to the beginning of varargin, and change funfcn to be</span><br/>               <span style="color: #A0A0A0"> 173</span> <span style="color: #228B22; background: #FFFFFF;">    % CHECKFUN.</span><br/><a name="Line174"></a>               <span style="color: #A0A0A0"> 174</span> <span style="color: #A0A0A0; background: #FFFFFF;">    varargin = {funfcn, varargin{:}};</span><br/>               <span style="color: #A0A0A0"> 175</span> <span style="color: #A0A0A0; background: #FFFFFF;">    funfcn = @checkfun;</span><br/>               <span style="color: #A0A0A0"> 176</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 177</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 178</span> <span style="color: #000000; background: #FFFFFF;">n = numel(x); </span><br/>               <span style="color: #A0A0A0"> 179</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 180</span> <span style="color: #228B22; background: #FFFFFF;">% Initialize parameters</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 181</span> <span style="color: #000000; background: #FFFFFF;">rho = 1; chi = 2; psi = 0.5; sigma = 0.5; </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 182</span> <span style="color: #000000; background: #FFFFFF;">onesn = ones(1,n); </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 183</span> <span style="color: #000000; background: #FFFFFF;">two2np1 = 2:n+1; </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 184</span> <span style="color: #000000; background: #FFFFFF;">one2n = 1:n; </span><br/>               <span style="color: #A0A0A0"> 185</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 186</span> <span style="color: #228B22; background: #FFFFFF;">% Set up a simplex near the initial guess.</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 187</span> <span style="color: #000000; background: #FFFFFF;">xin = x(:); % Force xin to be a column vector </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 188</span> <span style="color: #000000; background: #FFFFFF;">v = zeros(n,n+1); fv = zeros(1,n+1); </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 189</span> <span style="color: #000000; background: #FFFFFF;">v(:,1) = xin;    % Place input guess in the simplex! (credit L.Pfeffer at Stanford) </span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 190</span> <span style="color: #000000; background: #FFFFFF;">x(:) = xin;    % Change x to the form expected by funfcn </span><br/><span style="color: #FF0000">  1.23 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 191</span> <span style="color: #000000; background: #FFFFFF;">fv(:,1) = funfcn(x,varargin{:}); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 192</span> <span style="color: #000000; background: #FFFFFF;">func_evals = 1; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 193</span> <span style="color: #000000; background: #FFFFFF;">itercount = 0; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 194</span> <span style="color: #000000; background: #FFFFFF;">how = ''; </span><br/>               <span style="color: #A0A0A0"> 195</span> <span style="color: #228B22; background: #FFFFFF;">% Initial simplex setup continues later</span><br/>               <span style="color: #A0A0A0"> 196</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 197</span> <span style="color: #228B22; background: #FFFFFF;">% Initialize the output and plot functions.</span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 198</span> <span style="color: #000000; background: #FFFFFF;">if haveoutputfcn || haveplotfcn </span><br/>               <span style="color: #A0A0A0"> 199</span> <span style="color: #A0A0A0; background: #FFFFFF;">    [xOutputfcn, optimValues, stop] = callOutputAndPlotFcns(outputfcn,plotfcns,v(:,1),xOutputfcn,'init',itercount, ...</span><br/>               <span style="color: #A0A0A0"> 200</span> <span style="color: #A0A0A0; background: #FFFFFF;">        func_evals, how, fv(:,1),varargin{:});</span><br/>               <span style="color: #A0A0A0"> 201</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if stop</span><br/>               <span style="color: #A0A0A0"> 202</span> <span style="color: #A0A0A0; background: #FFFFFF;">        [x,fval,exitflag,output] = cleanUpInterrupt(xOutputfcn,optimValues);</span><br/>               <span style="color: #A0A0A0"> 203</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if  prnt &gt; 0</span><br/>               <span style="color: #A0A0A0"> 204</span> <span style="color: #A0A0A0; background: #FFFFFF;">            disp(output.message)</span><br/>               <span style="color: #A0A0A0"> 205</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 206</span> <span style="color: #A0A0A0; background: #FFFFFF;">        return;</span><br/>               <span style="color: #A0A0A0"> 207</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 208</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 209</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 210</span> <span style="color: #228B22; background: #FFFFFF;">% Print out initial f(x) as 0th iteration</span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 211</span> <span style="color: #000000; background: #FFFFFF;">if prnt == 3 </span><br/>               <span style="color: #A0A0A0"> 212</span> <span style="color: #A0A0A0; background: #FFFFFF;">    disp(' ')</span><br/>               <span style="color: #A0A0A0"> 213</span> <span style="color: #A0A0A0; background: #FFFFFF;">    disp(header)</span><br/>               <span style="color: #A0A0A0"> 214</span> <span style="color: #A0A0A0; background: #FFFFFF;">    fprintf(' %5.0f        %5.0f     %12.6g         %s\n', itercount, func_evals, fv(1), how);</span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 215</span> <span style="color: #000000; background: #FFFFFF;">elseif prnt == 4 </span><br/>               <span style="color: #A0A0A0"> 216</span> <span style="color: #A0A0A0; background: #FFFFFF;">    clc</span><br/>               <span style="color: #A0A0A0"> 217</span> <span style="color: #A0A0A0; background: #FFFFFF;">    formatsave = get(0,{'format','formatspacing'});</span><br/>               <span style="color: #A0A0A0"> 218</span> <span style="color: #A0A0A0; background: #FFFFFF;">    format compact</span><br/>               <span style="color: #A0A0A0"> 219</span> <span style="color: #A0A0A0; background: #FFFFFF;">    format short e</span><br/>               <span style="color: #A0A0A0"> 220</span> <span style="color: #A0A0A0; background: #FFFFFF;">    disp(' ')</span><br/>               <span style="color: #A0A0A0"> 221</span> <span style="color: #A0A0A0; background: #FFFFFF;">    disp(how)</span><br/><a name="Line222"></a>               <span style="color: #A0A0A0"> 222</span> <span style="color: #A0A0A0; background: #FFFFFF;">    v</span><br/><a name="Line223"></a>               <span style="color: #A0A0A0"> 223</span> <span style="color: #A0A0A0; background: #FFFFFF;">    fv</span><br/><a name="Line224"></a>               <span style="color: #A0A0A0"> 224</span> <span style="color: #A0A0A0; background: #FFFFFF;">    func_evals</span><br/>               <span style="color: #A0A0A0"> 225</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 226</span> <span style="color: #228B22; background: #FFFFFF;">% OutputFcn and PlotFcns call</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 227</span> <span style="color: #000000; background: #FFFFFF;">if haveoutputfcn || haveplotfcn </span><br/>               <span style="color: #A0A0A0"> 228</span> <span style="color: #A0A0A0; background: #FFFFFF;">    [xOutputfcn, optimValues, stop] = callOutputAndPlotFcns(outputfcn,plotfcns,v(:,1),xOutputfcn,'iter',itercount, ...</span><br/>               <span style="color: #A0A0A0"> 229</span> <span style="color: #A0A0A0; background: #FFFFFF;">        func_evals, how, fv(:,1),varargin{:});</span><br/>               <span style="color: #A0A0A0"> 230</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if stop  % Stop per user request.</span><br/>               <span style="color: #A0A0A0"> 231</span> <span style="color: #A0A0A0; background: #FFFFFF;">        [x,fval,exitflag,output] = cleanUpInterrupt(xOutputfcn,optimValues);</span><br/>               <span style="color: #A0A0A0"> 232</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if  prnt &gt; 0</span><br/>               <span style="color: #A0A0A0"> 233</span> <span style="color: #A0A0A0; background: #FFFFFF;">            disp(output.message)</span><br/>               <span style="color: #A0A0A0"> 234</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 235</span> <span style="color: #A0A0A0; background: #FFFFFF;">        return;</span><br/>               <span style="color: #A0A0A0"> 236</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 237</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 238</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 239</span> <span style="color: #228B22; background: #FFFFFF;">% Continue setting up the initial simplex.</span><br/>               <span style="color: #A0A0A0"> 240</span> <span style="color: #228B22; background: #FFFFFF;">% Following improvement suggested by L.Pfeffer at Stanford</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 241</span> <span style="color: #000000; background: #FFFFFF;">usual_delta = 0.05;             % 5 percent deltas for non-zero terms </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 242</span> <span style="color: #000000; background: #FFFFFF;">zero_term_delta = 0.00025;      % Even smaller delta for zero elements of x </span><br/><span style="color: #FF0000">  0.10 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 243</span> <span style="color: #000000; background: #FFFFFF;">for j = 1:n </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">  16008 </span><span style="color: #000000; font-weight: bold"> 244</span> <span style="color: #000000; background: #FFFFFF;">    y = xin; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  16008 </span><span style="color: #000000; font-weight: bold"> 245</span> <span style="color: #000000; background: #FFFFFF;">    if y(j) ~= 0 </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">  16008 </span><span style="color: #000000; font-weight: bold"> 246</span> <span style="color: #000000; background: #FFFFFF;">        y(j) = (1 + usual_delta)*y(j); </span><br/>               <span style="color: #A0A0A0"> 247</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 248</span> <span style="color: #A0A0A0; background: #FFFFFF;">        y(j) = zero_term_delta;</span><br/>               <span style="color: #A0A0A0"> 249</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/><span style="color: #FF0000">  0.07 </span><span style="color: #0000FF">  16008 </span><span style="color: #000000; font-weight: bold"> 250</span> <span style="color: #000000; background: #FFFFFF;">    v(:,j+1) = y; </span><br/><span style="color: #FF0000">  2.44 </span><span style="color: #0000FF">  16008 </span><span style="color: #000000; font-weight: bold"> 251</span> <a name="Line251"></a><span style="color: #000000; background: #FFF0F0;">    x(:) = y; f = funfcn(x,varargin{:}); </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">  16008 </span><span style="color: #000000; font-weight: bold"> 252</span> <span style="color: #000000; background: #FFFFFF;">    fv(1,j+1) = f; </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">  16008 </span><span style="color: #000000; font-weight: bold"> 253</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 254</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 255</span> <span style="color: #228B22; background: #FFFFFF;">% sort so v(1,:) has the lowest function value</span><br/><span style="color: #FF0000">  0.10 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 256</span> <span style="color: #000000; background: #FFFFFF;">[fv,j] = sort(fv); </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 257</span> <span style="color: #000000; background: #FFFFFF;">v = v(:,j); </span><br/>               <span style="color: #A0A0A0"> 258</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 259</span> <span style="color: #000000; background: #FFFFFF;">how = 'initial simplex'; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 260</span> <span style="color: #000000; background: #FFFFFF;">itercount = itercount + 1; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 261</span> <span style="color: #000000; background: #FFFFFF;">func_evals = n+1; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 262</span> <span style="color: #000000; background: #FFFFFF;">if prnt == 3 </span><br/>               <span style="color: #A0A0A0"> 263</span> <span style="color: #A0A0A0; background: #FFFFFF;">    fprintf(' %5.0f        %5.0f     %12.6g         %s\n', itercount, func_evals, fv(1), how)</span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 264</span> <span style="color: #000000; background: #FFFFFF;">elseif prnt == 4 </span><br/>               <span style="color: #A0A0A0"> 265</span> <span style="color: #A0A0A0; background: #FFFFFF;">    disp(' ')</span><br/>               <span style="color: #A0A0A0"> 266</span> <span style="color: #A0A0A0; background: #FFFFFF;">    disp(how)</span><br/><a name="Line267"></a>               <span style="color: #A0A0A0"> 267</span> <span style="color: #A0A0A0; background: #FFFFFF;">    v</span><br/><a name="Line268"></a>               <span style="color: #A0A0A0"> 268</span> <span style="color: #A0A0A0; background: #FFFFFF;">    fv</span><br/><a name="Line269"></a>               <span style="color: #A0A0A0"> 269</span> <span style="color: #A0A0A0; background: #FFFFFF;">    func_evals</span><br/>               <span style="color: #A0A0A0"> 270</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 271</span> <span style="color: #228B22; background: #FFFFFF;">% OutputFcn and PlotFcns call</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 272</span> <span style="color: #000000; background: #FFFFFF;">if haveoutputfcn || haveplotfcn </span><br/>               <span style="color: #A0A0A0"> 273</span> <span style="color: #A0A0A0; background: #FFFFFF;">    [xOutputfcn, optimValues, stop] = callOutputAndPlotFcns(outputfcn,plotfcns,v(:,1),xOutputfcn,'iter',itercount, ...</span><br/>               <span style="color: #A0A0A0"> 274</span> <span style="color: #A0A0A0; background: #FFFFFF;">        func_evals, how, fv(:,1),varargin{:});</span><br/>               <span style="color: #A0A0A0"> 275</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if stop  % Stop per user request.</span><br/>               <span style="color: #A0A0A0"> 276</span> <span style="color: #A0A0A0; background: #FFFFFF;">        [x,fval,exitflag,output] = cleanUpInterrupt(xOutputfcn,optimValues);</span><br/>               <span style="color: #A0A0A0"> 277</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if  prnt &gt; 0</span><br/>               <span style="color: #A0A0A0"> 278</span> <span style="color: #A0A0A0; background: #FFFFFF;">            disp(output.message)</span><br/>               <span style="color: #A0A0A0"> 279</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 280</span> <span style="color: #A0A0A0; background: #FFFFFF;">        return;</span><br/>               <span style="color: #A0A0A0"> 281</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 282</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/><a name="Line283"></a><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 283</span> <span style="color: #000000; background: #FFFFFF;">exitflag = 1; </span><br/>               <span style="color: #A0A0A0"> 284</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 285</span> <span style="color: #228B22; background: #FFFFFF;">% Main algorithm: iterate until </span><br/>               <span style="color: #A0A0A0"> 286</span> <span style="color: #228B22; background: #FFFFFF;">% (a) the maximum coordinate difference between the current best point and the </span><br/>               <span style="color: #A0A0A0"> 287</span> <span style="color: #228B22; background: #FFFFFF;">% other points in the simplex is less than or equal to TolX. Specifically,</span><br/>               <span style="color: #A0A0A0"> 288</span> <span style="color: #228B22; background: #FFFFFF;">% until max(||v2-v1||,||v2-v1||,...,||v(n+1)-v1||) &lt;= TolX,</span><br/>               <span style="color: #A0A0A0"> 289</span> <span style="color: #228B22; background: #FFFFFF;">% where ||.|| is the infinity-norm, and v1 holds the </span><br/>               <span style="color: #A0A0A0"> 290</span> <span style="color: #228B22; background: #FFFFFF;">% vertex with the current lowest value; AND</span><br/>               <span style="color: #A0A0A0"> 291</span> <span style="color: #228B22; background: #FFFFFF;">% (b) the corresponding difference in function values is less than or equal</span><br/>               <span style="color: #A0A0A0"> 292</span> <span style="color: #228B22; background: #FFFFFF;">% to TolFun. (Cannot use OR instead of AND.)</span><br/>               <span style="color: #A0A0A0"> 293</span> <span style="color: #228B22; background: #FFFFFF;">% The iteration stops if the maximum number of iterations or function evaluations </span><br/>               <span style="color: #A0A0A0"> 294</span> <span style="color: #228B22; background: #FFFFFF;">% are exceeded</span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 295</span> <span style="color: #000000; background: #FFFFFF;">while func_evals &lt; maxfun &amp;&amp; itercount &lt; maxiter </span><br/><span style="color: #FF0000">  1.52 </span><span style="color: #0000FF">  80036 </span><span style="color: #000000; font-weight: bold"> 296</span> <span style="color: #000000; background: #FFFFFF;">    if max(abs(fv(1)-fv(two2np1))) &lt;= max(tolf,10*eps(fv(1))) &amp;&amp; ... </span><br/>               <span style="color: #A0A0A0"> 297</span> <span style="color: #000000; background: #FFFFFF;">            max(max(abs(v(:,two2np1)-v(:,onesn)))) &lt;= max(tolx,10*eps(max(v(:,1))))</span><br/><span style="color: #FF0000">  0.07 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 298</span> <span style="color: #000000; background: #FFFFFF;">        break </span><br/>               <span style="color: #A0A0A0"> 299</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 300</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 301</span> <span style="color: #228B22; background: #FFFFFF;">    % Compute the reflection point</span><br/>               <span style="color: #A0A0A0"> 302</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 303</span> <span style="color: #228B22; background: #FFFFFF;">    % xbar = average of the n (NOT n+1) best points</span><br/><span style="color: #FF0000">  1.86 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 304</span> <a name="Line304"></a><span style="color: #000000; background: #FFFFFF;">    xbar = sum(v(:,one2n), 2)/n; </span><br/><span style="color: #FF0000">  0.46 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 305</span> <span style="color: #000000; background: #FFFFFF;">    xr = (1 + rho)*xbar - rho*v(:,end); </span><br/><span style="color: #FF0000"> 11.13 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 306</span> <a name="Line306"></a><span style="color: #000000; background: #FFC6C6;">    x(:) = xr; fxr = funfcn(x,varargin{:}); </span><br/><span style="color: #FF0000">  0.15 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 307</span> <span style="color: #000000; background: #FFFFFF;">    func_evals = func_evals+1; </span><br/>               <span style="color: #A0A0A0"> 308</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/><span style="color: #FF0000">  0.37 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 309</span> <span style="color: #000000; background: #FFFFFF;">    if fxr &lt; fv(:,1) </span><br/>               <span style="color: #A0A0A0"> 310</span> <span style="color: #228B22; background: #FFFFFF;">        % Calculate the expansion point</span><br/>               <span style="color: #A0A0A0"> 311</span> <span style="color: #A0A0A0; background: #FFFFFF;">        xe = (1 + rho*chi)*xbar - rho*chi*v(:,end);</span><br/>               <span style="color: #A0A0A0"> 312</span> <span style="color: #A0A0A0; background: #FFFFFF;">        x(:) = xe; fxe = funfcn(x,varargin{:});</span><br/>               <span style="color: #A0A0A0"> 313</span> <span style="color: #A0A0A0; background: #FFFFFF;">        func_evals = func_evals+1;</span><br/>               <span style="color: #A0A0A0"> 314</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if fxe &lt; fxr</span><br/>               <span style="color: #A0A0A0"> 315</span> <span style="color: #A0A0A0; background: #FFFFFF;">            v(:,end) = xe;</span><br/>               <span style="color: #A0A0A0"> 316</span> <span style="color: #A0A0A0; background: #FFFFFF;">            fv(:,end) = fxe;</span><br/>               <span style="color: #A0A0A0"> 317</span> <span style="color: #A0A0A0; background: #FFFFFF;">            how = 'expand';</span><br/>               <span style="color: #A0A0A0"> 318</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 319</span> <span style="color: #A0A0A0; background: #FFFFFF;">            v(:,end) = xr;</span><br/>               <span style="color: #A0A0A0"> 320</span> <span style="color: #A0A0A0; background: #FFFFFF;">            fv(:,end) = fxr;</span><br/>               <span style="color: #A0A0A0"> 321</span> <span style="color: #A0A0A0; background: #FFFFFF;">            how = 'reflect';</span><br/>               <span style="color: #A0A0A0"> 322</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 323</span> <span style="color: #228B22; background: #FFFFFF;">    else % fv(:,1) &lt;= fxr </span><br/><span style="color: #FF0000">  0.17 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 324</span> <span style="color: #000000; background: #FFFFFF;">        if fxr &lt; fv(:,n) </span><br/>               <span style="color: #A0A0A0"> 325</span> <span style="color: #A0A0A0; background: #FFFFFF;">            v(:,end) = xr;</span><br/>               <span style="color: #A0A0A0"> 326</span> <span style="color: #A0A0A0; background: #FFFFFF;">            fv(:,end) = fxr;</span><br/>               <span style="color: #A0A0A0"> 327</span> <span style="color: #A0A0A0; background: #FFFFFF;">            how = 'reflect';</span><br/><span style="color: #FF0000">  0.06 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 328</span> <span style="color: #228B22; background: #FFFFFF;">        else % fxr &gt;= fv(:,n) </span><br/>               <span style="color: #A0A0A0"> 329</span> <span style="color: #228B22; background: #FFFFFF;">            % Perform contraction</span><br/><span style="color: #FF0000">  0.72 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 330</span> <span style="color: #000000; background: #FFFFFF;">            if fxr &lt; fv(:,end) </span><br/>               <span style="color: #A0A0A0"> 331</span> <span style="color: #228B22; background: #FFFFFF;">                % Perform an outside contraction</span><br/>               <span style="color: #A0A0A0"> 332</span> <span style="color: #A0A0A0; background: #FFFFFF;">                xc = (1 + psi*rho)*xbar - psi*rho*v(:,end);</span><br/>               <span style="color: #A0A0A0"> 333</span> <span style="color: #A0A0A0; background: #FFFFFF;">                x(:) = xc; fxc = funfcn(x,varargin{:});</span><br/>               <span style="color: #A0A0A0"> 334</span> <span style="color: #A0A0A0; background: #FFFFFF;">                func_evals = func_evals+1;</span><br/>               <span style="color: #A0A0A0"> 335</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/>               <span style="color: #A0A0A0"> 336</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if fxc &lt;= fxr</span><br/>               <span style="color: #A0A0A0"> 337</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    v(:,end) = xc;</span><br/>               <span style="color: #A0A0A0"> 338</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    fv(:,end) = fxc;</span><br/>               <span style="color: #A0A0A0"> 339</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    how = 'contract outside';</span><br/>               <span style="color: #A0A0A0"> 340</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 341</span> <span style="color: #228B22; background: #FFFFFF;">                    % perform a shrink</span><br/>               <span style="color: #A0A0A0"> 342</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    how = 'shrink';</span><br/>               <span style="color: #A0A0A0"> 343</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/><span style="color: #FF0000">  0.07 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 344</span> <span style="color: #228B22; background: #FFFFFF;">            else </span><br/>               <span style="color: #A0A0A0"> 345</span> <span style="color: #228B22; background: #FFFFFF;">                % Perform an inside contraction</span><br/><span style="color: #FF0000">  0.38 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 346</span> <span style="color: #000000; background: #FFFFFF;">                xcc = (1-psi)*xbar + psi*v(:,end); </span><br/><span style="color: #FF0000"> 10.96 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 347</span> <a name="Line347"></a><span style="color: #000000; background: #FFC6C6;">                x(:) = xcc; fxcc = funfcn(x,varargin{:}); </span><br/><span style="color: #FF0000">  0.06 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 348</span> <span style="color: #000000; background: #FFFFFF;">                func_evals = func_evals+1; </span><br/>               <span style="color: #A0A0A0"> 349</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/><span style="color: #FF0000">  0.32 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 350</span> <span style="color: #000000; background: #FFFFFF;">                if fxcc &lt; fv(:,end) </span><br/>               <span style="color: #A0A0A0"> 351</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    v(:,end) = xcc;</span><br/>               <span style="color: #A0A0A0"> 352</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    fv(:,end) = fxcc;</span><br/>               <span style="color: #A0A0A0"> 353</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    how = 'contract inside';</span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 354</span> <span style="color: #228B22; background: #FFFFFF;">                else </span><br/>               <span style="color: #A0A0A0"> 355</span> <span style="color: #228B22; background: #FFFFFF;">                    % perform a shrink</span><br/><span style="color: #FF0000">  0.11 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 356</span> <span style="color: #000000; background: #FFFFFF;">                    how = 'shrink'; </span><br/><span style="color: #FF0000">  0.17 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 357</span> <span style="color: #000000; background: #FFFFFF;">                end </span><br/><span style="color: #FF0000">  0.13 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 358</span> <span style="color: #000000; background: #FFFFFF;">            end </span><br/><span style="color: #FF0000">  0.31 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 359</span> <span style="color: #000000; background: #FFFFFF;">            if strcmp(how,'shrink') </span><br/><span style="color: #FF0000">  0.44 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 360</span> <span style="color: #000000; background: #FFFFFF;">                for j=two2np1 </span><br/><span style="color: #FF0000">  0.49 </span><span style="color: #0000FF"> 144064 </span><span style="color: #000000; font-weight: bold"> 361</span> <span style="color: #000000; background: #FFFFFF;">                    v(:,j)=v(:,1)+sigma*(v(:,j) - v(:,1)); </span><br/><span style="color: #FF0000"> 22.44 </span><span style="color: #0000FF"> 144064 </span><span style="color: #000000; font-weight: bold"> 362</span> <a name="Line362"></a><span style="color: #000000; background: #FF8080;">                    x(:) = v(:,j); fv(:,j) = funfcn(x,varargin{:}); </span><br/><span style="color: #FF0000">  0.58 </span><span style="color: #0000FF"> 144064 </span><span style="color: #000000; font-weight: bold"> 363</span> <span style="color: #000000; background: #FFFFFF;">                end </span><br/><span style="color: #FF0000">  0.14 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 364</span> <span style="color: #000000; background: #FFFFFF;">                func_evals = func_evals + n; </span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 365</span> <span style="color: #000000; background: #FFFFFF;">            end </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 366</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 367</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/><span style="color: #FF0000">  0.89 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 368</span> <span style="color: #000000; background: #FFFFFF;">    [fv,j] = sort(fv); </span><br/><span style="color: #FF0000">  0.27 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 369</span> <span style="color: #000000; background: #FFFFFF;">    v = v(:,j); </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 370</span> <span style="color: #000000; background: #FFFFFF;">    itercount = itercount + 1; </span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 371</span> <span style="color: #000000; background: #FFFFFF;">    if prnt == 3 </span><br/>               <span style="color: #A0A0A0"> 372</span> <span style="color: #A0A0A0; background: #FFFFFF;">        fprintf(' %5.0f        %5.0f     %12.6g         %s\n', itercount, func_evals, fv(1), how)</span><br/><span style="color: #FF0000">  0.17 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 373</span> <span style="color: #000000; background: #FFFFFF;">    elseif prnt == 4 </span><br/>               <span style="color: #A0A0A0"> 374</span> <span style="color: #A0A0A0; background: #FFFFFF;">        disp(' ')</span><br/>               <span style="color: #A0A0A0"> 375</span> <span style="color: #A0A0A0; background: #FFFFFF;">        disp(how)</span><br/><a name="Line376"></a>               <span style="color: #A0A0A0"> 376</span> <span style="color: #A0A0A0; background: #FFFFFF;">        v</span><br/><a name="Line377"></a>               <span style="color: #A0A0A0"> 377</span> <span style="color: #A0A0A0; background: #FFFFFF;">        fv</span><br/><a name="Line378"></a>               <span style="color: #A0A0A0"> 378</span> <span style="color: #A0A0A0; background: #FFFFFF;">        func_evals</span><br/>               <span style="color: #A0A0A0"> 379</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 380</span> <span style="color: #228B22; background: #FFFFFF;">    % OutputFcn and PlotFcns call</span><br/><span style="color: #FF0000">  0.12 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 381</span> <span style="color: #000000; background: #FFFFFF;">    if haveoutputfcn || haveplotfcn </span><br/>               <span style="color: #A0A0A0"> 382</span> <span style="color: #A0A0A0; background: #FFFFFF;">        [xOutputfcn, optimValues, stop] = callOutputAndPlotFcns(outputfcn,plotfcns,v(:,1),xOutputfcn,'iter',itercount, ...</span><br/>               <span style="color: #A0A0A0"> 383</span> <span style="color: #A0A0A0; background: #FFFFFF;">            func_evals, how, fv(:,1),varargin{:});</span><br/>               <span style="color: #A0A0A0"> 384</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if stop  % Stop per user request.</span><br/>               <span style="color: #A0A0A0"> 385</span> <span style="color: #A0A0A0; background: #FFFFFF;">            [x,fval,exitflag,output] = cleanUpInterrupt(xOutputfcn,optimValues);</span><br/>               <span style="color: #A0A0A0"> 386</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if  prnt &gt; 0</span><br/>               <span style="color: #A0A0A0"> 387</span> <span style="color: #A0A0A0; background: #FFFFFF;">                disp(output.message)</span><br/>               <span style="color: #A0A0A0"> 388</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 389</span> <span style="color: #A0A0A0; background: #FFFFFF;">            return;</span><br/>               <span style="color: #A0A0A0"> 390</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 391</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/><span style="color: #FF0000">  0.31 </span><span style="color: #0000FF">  72032 </span><span style="color: #000000; font-weight: bold"> 392</span> <span style="color: #000000; background: #FFFFFF;">end   % while </span><br/>               <span style="color: #A0A0A0"> 393</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 394</span> <span style="color: #000000; background: #FFFFFF;">x(:) = v(:,1); </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 395</span> <span style="color: #000000; background: #FFFFFF;">fval = fv(:,1); </span><br/>               <span style="color: #A0A0A0"> 396</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 397</span> <span style="color: #000000; background: #FFFFFF;">if prnt == 4, </span><br/>               <span style="color: #A0A0A0"> 398</span> <span style="color: #228B22; background: #FFFFFF;">    % reset format</span><br/>               <span style="color: #A0A0A0"> 399</span> <span style="color: #A0A0A0; background: #FFFFFF;">    set(0,{'format','formatspacing'},formatsave);</span><br/>               <span style="color: #A0A0A0"> 400</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 401</span> <span style="color: #000000; background: #FFFFFF;">output.iterations = itercount; </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 402</span> <span style="color: #000000; background: #FFFFFF;">output.funcCount = func_evals; </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 403</span> <span style="color: #000000; background: #FFFFFF;">output.algorithm = 'Nelder-Mead simplex direct search'; </span><br/>               <span style="color: #A0A0A0"> 404</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 405</span> <span style="color: #228B22; background: #FFFFFF;">% OutputFcn and PlotFcns call</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 406</span> <span style="color: #000000; background: #FFFFFF;">if haveoutputfcn || haveplotfcn </span><br/>               <span style="color: #A0A0A0"> 407</span> <span style="color: #A0A0A0; background: #FFFFFF;">    callOutputAndPlotFcns(outputfcn,plotfcns,x,xOutputfcn,'done',itercount, func_evals, how, fval, varargin{:});</span><br/>               <span style="color: #A0A0A0"> 408</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 409</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 410</span> <span style="color: #000000; background: #FFFFFF;">if func_evals &gt;= maxfun </span><br/>               <span style="color: #A0A0A0"> 411</span> <span style="color: #A0A0A0; background: #FFFFFF;">    msg = sprintf(['Exiting: Maximum number of function evaluations has been exceeded\n' ...</span><br/>               <span style="color: #A0A0A0"> 412</span> <span style="color: #A0A0A0; background: #FFFFFF;">                   '         - increase MaxFunEvals option.\n' ...</span><br/>               <span style="color: #A0A0A0"> 413</span> <span style="color: #A0A0A0; background: #FFFFFF;">                   '         Current function value: %f \n'], fval);</span><br/>               <span style="color: #A0A0A0"> 414</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if prnt &gt; 0</span><br/>               <span style="color: #A0A0A0"> 415</span> <span style="color: #A0A0A0; background: #FFFFFF;">        disp(' ')</span><br/>               <span style="color: #A0A0A0"> 416</span> <span style="color: #A0A0A0; background: #FFFFFF;">        disp(msg)</span><br/>               <span style="color: #A0A0A0"> 417</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 418</span> <span style="color: #A0A0A0; background: #FFFFFF;">    exitflag = 0;</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 419</span> <span style="color: #000000; background: #FFFFFF;">elseif itercount &gt;= maxiter </span><br/>               <span style="color: #A0A0A0"> 420</span> <span style="color: #A0A0A0; background: #FFFFFF;">    msg = sprintf(['Exiting: Maximum number of iterations has been exceeded\n' ... </span><br/>               <span style="color: #A0A0A0"> 421</span> <span style="color: #A0A0A0; background: #FFFFFF;">                   '         - increase MaxIter option.\n' ...</span><br/>               <span style="color: #A0A0A0"> 422</span> <span style="color: #A0A0A0; background: #FFFFFF;">                   '         Current function value: %f \n'], fval);</span><br/>               <span style="color: #A0A0A0"> 423</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if prnt &gt; 0</span><br/>               <span style="color: #A0A0A0"> 424</span> <span style="color: #A0A0A0; background: #FFFFFF;">        disp(' ')</span><br/>               <span style="color: #A0A0A0"> 425</span> <span style="color: #A0A0A0; background: #FFFFFF;">        disp(msg)</span><br/>               <span style="color: #A0A0A0"> 426</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 427</span> <span style="color: #A0A0A0; background: #FFFFFF;">    exitflag = 0;</span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 428</span> <span style="color: #228B22; background: #FFFFFF;">else </span><br/><span style="color: #FF0000">  0.29 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 429</span> <span style="color: #000000; background: #FFFFFF;">    msg = ... </span><br/>               <span style="color: #A0A0A0"> 430</span> <span style="color: #000000; background: #FFFFFF;">      sprintf(['Optimization terminated:\n', ...</span><br/>               <span style="color: #A0A0A0"> 431</span> <span style="color: #000000; background: #FFFFFF;">               ' the current x satisfies the termination criteria using OPTIONS.TolX of %e \n' ...</span><br/>               <span style="color: #A0A0A0"> 432</span> <span style="color: #000000; background: #FFFFFF;">               ' and F(X) satisfies the convergence criteria using OPTIONS.TolFun of %e \n'], ...</span><br/>               <span style="color: #A0A0A0"> 433</span> <span style="color: #000000; background: #FFFFFF;">               tolx, tolf);</span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 434</span> <span style="color: #000000; background: #FFFFFF;">    if prnt &gt; 1 </span><br/>               <span style="color: #A0A0A0"> 435</span> <span style="color: #A0A0A0; background: #FFFFFF;">        disp(' ')</span><br/>               <span style="color: #A0A0A0"> 436</span> <span style="color: #A0A0A0; background: #FFFFFF;">        disp(msg)</span><br/>               <span style="color: #A0A0A0"> 437</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 438</span> <span style="color: #000000; background: #FFFFFF;">    exitflag = 1; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 439</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 440</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.11 </span><span style="color: #0000FF">   8004 </span><span style="color: #000000; font-weight: bold"> 441</span> <span style="color: #000000; background: #FFFFFF;">output.message = msg; </span><br/></pre><p><p>Other subfunctions in this file are not included in this listing.</body></html>