<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Function details for IG_AmNat</title><link rel="stylesheet" href="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">IG_AmNat (1 call, 68.152 sec)</span><br/><i>Generated 22-Feb-2012 12:20:14 using cpu time.</i><br/>script in file /ibrix/users/home13/jburkhar/software_projects/plbm/IG_AmNat pgms/IG_AmNat.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/> No parent <div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line236">236</a></td><td class="td-linebottomrt"><pre>parfor i = 1:reps    % what th...</pre></td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">67.291 s</td><td class="td-linebottomrt" class="td-linebottomrt">98.7%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=99 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line282">282</a></td><td class="td-linebottomrt"><pre>pause(.1)</pre></td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0.168 s</td><td class="td-linebottomrt" class="td-linebottomrt">0.2%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line274">274</a></td><td class="td-linebottomrt"><pre>figure(2*(aflag-1)+(Vhflag-1)+...</pre></td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0.155 s</td><td class="td-linebottomrt" class="td-linebottomrt">0.2%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line193">193</a></td><td class="td-linebottomrt"><pre>[L D]=eig(Vtrue);</pre></td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0.110 s</td><td class="td-linebottomrt" class="td-linebottomrt">0.2%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line158">158</a></td><td class="td-linebottomrt"><pre>[est MSE]=fminsearch('IGfunct'...</pre></td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0.087 s</td><td class="td-linebottomrt" class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.341 s</td><td class="td-linebottomrt">0.5%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">68.152 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file23.html">parallel_function</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">67.266 s</td><td class="td-linebottomrt">98.7%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=99 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file4.html">gpuArray</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0.074 s</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file18.html">fminsearch</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0.072 s</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file7.html">optimset</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0.028 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file67.html">subplot</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">12</td><td class="td-linebottomrt">0.020 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file76.html">newplot</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">12</td><td class="td-linebottomrt">0.017 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file1.html">kron</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">16</td><td class="td-linebottomrt">0.014 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file61.html">corrcoef</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0.008 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file72.html">lineseries</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">13</td><td class="td-linebottomrt">0.004 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file60.html">mean</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">62</td><td class="td-linebottomrt">0.004 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file6.html">cov</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0.004 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file62.html">datamanager.schema</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.003 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file25.html">parfor_endpoint_check</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">8</td><td class="td-linebottomrt">0.002 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file71.html">graph2d.schema</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file63.html">initprintexporttemplate</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file24.html">parfor_sliced_fcnhdl_check</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.637 s</td><td class="td-linebottomrt">0.9%</td><td class="td-linebottomrt"><img src="file:////ibrix/packages/MATLAB/R2011b/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">68.152 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>Code Analyzer results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line43">43</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (within a script).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line91">91</a></td><td class="td-linebottomrt"><span class="mono">The variable 'meanA' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line91">91</a></td><td class="td-linebottomrt"><span class="mono">To improve performance, use logical indexing instead of FIND.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line160">160</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (within a script).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line164">164</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (within a script).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line215">215</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (within a script).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line239">239</a></td><td class="td-linebottomrt"><span class="mono">Using GLOBAL variable 'n' in a PARFOR loop could fail because it accesses a worker machine's global area.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line243">243</a></td><td class="td-linebottomrt"><span class="mono">Variable 'resid' is indexed, but not sliced, in a PARFOR loop. This might result in unnecessary communication overhead.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line246">246</a></td><td class="td-linebottomrt"><span class="mono">The GLOBAL or PERSISTENT variable 'X' should not be set inside a PARFOR loop.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line246">246</a></td><td class="td-linebottomrt"><span class="mono">The temporary variable 'X' is used after the PARFOR loop, but its value is nondeterministic.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line263">263</a></td><td class="td-linebottomrt"><span class="mono">The variable 'conf' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line267">267</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (within a script).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line269">269</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (within a script).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line270">270</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (within a script).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line271">271</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (within a script).</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>[ Show coverage for parent directory ]<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">253</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">133</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">120</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">120</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">0</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">100.00 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  33</span> <span style="color: #000000; background: #FFFFFF;">global initVh initVp n p q X tau1 tau2 invV </span><br/>               <span style="color: #A0A0A0">  34</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  35</span> <span style="color: #000000; background: #FFFFFF;">load hostV.txt /ascii </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  36</span> <span style="color: #000000; background: #FFFFFF;">load paraV.txt /ascii </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  37</span> <span style="color: #000000; background: #FFFFFF;">load plantV.txt /ascii </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  38</span> <span style="color: #000000; background: #FFFFFF;">load hostparadata.txt /ascii </span><br/>               <span style="color: #A0A0A0">  39</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  40</span> <span style="color: #000000; background: #FFFFFF;">for aflag=1:2, </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold">  41</span> <span style="color: #000000; background: #FFFFFF;">	for Vhflag=1:2, </span><br/>               <span style="color: #A0A0A0">  42</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line43"></a>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  43</span> <span style="color: #000000; background: #FFFFFF;">		flags=[aflag,Vhflag] </span><br/>               <span style="color: #A0A0A0">  44</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  45</span> <span style="color: #228B22; background: #FFFFFF;">		% Assign host phylogeny</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  46</span> <span style="color: #000000; background: #FFFFFF;">		if Vhflag==1, </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold">  47</span> <span style="color: #000000; background: #FFFFFF;">			Vh=hostV(2:end,2:end); </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold">  48</span> <span style="color: #000000; background: #FFFFFF;">		end </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  49</span> <span style="color: #000000; background: #FFFFFF;">		if Vhflag==2, </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold">  50</span> <span style="color: #000000; background: #FFFFFF;">			Vh=plantV(2:end,2:end); </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold">  51</span> <span style="color: #000000; background: #FFFFFF;">		end </span><br/>               <span style="color: #A0A0A0">  52</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  53</span> <span style="color: #228B22; background: #FFFFFF;">		% Assign parasitoid phylogeny</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  54</span> <span style="color: #000000; background: #FFFFFF;">		Vp=paraV(2:end,2:end); </span><br/>               <span style="color: #A0A0A0">  55</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  56</span> <span style="color: #228B22; background: #FFFFFF;">		% number of hosts</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  57</span> <span style="color: #000000; background: #FFFFFF;">		p=length(Vh); </span><br/>               <span style="color: #A0A0A0">  58</span> <span style="color: #228B22; background: #FFFFFF;">		% number of parasitoids</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  59</span> <span style="color: #000000; background: #FFFFFF;">		q=length(Vp); </span><br/>               <span style="color: #A0A0A0">  60</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  61</span> <span style="color: #228B22; background: #FFFFFF;">		% Make tips of the phylogenetic trees contemporaneous by extending tips</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  62</span> <span style="color: #000000; background: #FFFFFF;">		for i=1:p, </span><br/>       <span style="color: #0000FF">     48 </span><span style="color: #000000; font-weight: bold">  63</span> <span style="color: #000000; background: #FFFFFF;">			Vh(i,i)=max(diag(Vh)); </span><br/>       <span style="color: #0000FF">     48 </span><span style="color: #000000; font-weight: bold">  64</span> <span style="color: #000000; background: #FFFFFF;">		end </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  65</span> <span style="color: #000000; background: #FFFFFF;">		for i=1:q, </span><br/>       <span style="color: #0000FF">    108 </span><span style="color: #000000; font-weight: bold">  66</span> <span style="color: #000000; background: #FFFFFF;">			Vp(i,i)=max(diag(Vp)); </span><br/>       <span style="color: #0000FF">    108 </span><span style="color: #000000; font-weight: bold">  67</span> <span style="color: #000000; background: #FFFFFF;">		end </span><br/>               <span style="color: #A0A0A0">  68</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  69</span> <span style="color: #228B22; background: #FFFFFF;">		% scale covariance matrices (this reduces numerical problems caused by</span><br/>               <span style="color: #A0A0A0">  70</span> <span style="color: #228B22; background: #FFFFFF;">		% determinants going to infinity or zero)</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  71</span> <span style="color: #000000; background: #FFFFFF;">		Vh=Vh./det(Vh)^(1/p); </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  72</span> <span style="color: #000000; background: #FFFFFF;">		Vp=Vp./det(Vp)^(1/q); </span><br/>               <span style="color: #A0A0A0">  73</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  74</span> <span style="color: #228B22; background: #FFFFFF;">		% Assign data</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  75</span> <span style="color: #000000; background: #FFFFFF;">		F=hostparadata(:,1:27); </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  76</span> <span style="color: #000000; background: #FFFFFF;">		hostden=hostparadata(:,29); </span><br/>               <span style="color: #A0A0A0">  77</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  78</span> <span style="color: #228B22; background: #FFFFFF;">		% Equation (4)</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  79</span> <span style="color: #000000; background: #FFFFFF;">		H=hostden*ones(1,27); </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  80</span> <span style="color: #000000; background: #FFFFFF;">		A=-log(1-F./H); </span><br/>               <span style="color: #A0A0A0">  81</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  82</span> <span style="color: #228B22; background: #FFFFFF;">		% Use A_ik</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  83</span> <span style="color: #000000; background: #FFFFFF;">		if aflag==1, </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold">  84</span> <span style="color: #000000; background: #FFFFFF;">			X=A; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold">  85</span> <span style="color: #000000; background: #FFFFFF;">		end </span><br/>               <span style="color: #A0A0A0">  86</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  87</span> <span style="color: #228B22; background: #FFFFFF;">		% Use a_ik by standardizing across parasitoid densities</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  88</span> <span style="color: #000000; background: #FFFFFF;">		if aflag==2, </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold">  89</span> <span style="color: #000000; background: #FFFFFF;">			meanA=[]; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold">  90</span> <span style="color: #000000; background: #FFFFFF;">			for i=1:q, </span><br/><a name="Line91"></a><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     54 </span><span style="color: #000000; font-weight: bold">  91</span> <span style="color: #000000; background: #FFFFFF;">				meanA=[meanA <a href="file60.html">mean</a>(A(find(A(:,i)&gt;0),i))]; </span><br/>               <span style="color: #A0A0A0">  92</span> <span style="color: #228B22; background: #FFFFFF;">				%meanA=[meanA mean(A(:,i))];</span><br/>       <span style="color: #0000FF">     54 </span><span style="color: #000000; font-weight: bold">  93</span> <span style="color: #000000; background: #FFFFFF;">			end </span><br/>               <span style="color: #A0A0A0">  94</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold">  95</span> <span style="color: #000000; background: #FFFFFF;">			meanst=ones(p,1)*meanA; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold">  96</span> <span style="color: #000000; background: #FFFFFF;">			X=A./meanst; </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold">  97</span> <span style="color: #000000; background: #FFFFFF;">		end </span><br/>               <span style="color: #A0A0A0">  98</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  99</span> <span style="color: #228B22; background: #FFFFFF;">		% Square-root transform data</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 100</span> <span style="color: #000000; background: #FFFFFF;">		X=X(:); </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 101</span> <span style="color: #000000; background: #FFFFFF;">		X=X.^.5; </span><br/>               <span style="color: #A0A0A0"> 102</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 103</span> <span style="color: #000000; background: #FFFFFF;">		n=length(X); </span><br/>               <span style="color: #A0A0A0"> 104</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 105</span> <span style="color: #228B22; background: #FFFFFF;">		% Compute the Kronecker product of Vp and Vh (eq 1)</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 106</span> <span style="color: #000000; background: #FFFFFF;">		V=<a href="file1.html">kron</a>(Vp,Vh); </span><br/>               <span style="color: #A0A0A0"> 107</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 108</span> <span style="color: #228B22; background: #FFFFFF;">		% Compute the MSE for the case using the "true" phylogenies (d = 1)</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 109</span> <span style="color: #000000; background: #FFFFFF;">		U=ones(size(X)); </span><br/>               <span style="color: #A0A0A0"> 110</span> <span style="color: #228B22; background: #FFFFFF;">		</span><br/>               <span style="color: #A0A0A0"> 111</span> <span style="color: #228B22; background: #FFFFFF;">		%invV=V\eye(n); %this takes a long time</span><br/><span style="color: #FF0000">  0.07 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 112</span> <span style="color: #000000; background: #FFFFFF;">		Vg=<a href="file4.html">gpuArray</a>(V); %push V to gpu memory </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 113</span> <span style="color: #000000; background: #FFFFFF;">		invVg=Vg\parallel.gpu.GPUArray.eye(n); %try this instead </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 114</span> <span style="color: #000000; background: #FFFFFF;">		invV=gather(invVg); %push back to cpu </span><br/>               <span style="color: #A0A0A0"> 115</span> <span style="color: #228B22; background: #FFFFFF;">		</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 116</span> <span style="color: #000000; background: #FFFFFF;">		aa=(U'*invV*U)\(U'*invV*X); </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 117</span> <span style="color: #000000; background: #FFFFFF;">		MSEbase=((X-U*aa)'*invV*(X-U*aa))/(n-1); </span><br/>               <span style="color: #A0A0A0"> 118</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 119</span> <span style="color: #228B22; background: #FFFFFF;">		% Compute the MSE for the case using the "star" phylogenies (d = 0)</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 120</span> <span style="color: #000000; background: #FFFFFF;">		MSEStar=<a href="file6.html">cov</a>(X); </span><br/>               <span style="color: #A0A0A0"> 121</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 122</span> <span style="color: #228B22; background: #FFFFFF;">		%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br/>               <span style="color: #A0A0A0"> 123</span> <span style="color: #228B22; background: #FFFFFF;">		% EGLS Estimation</span><br/>               <span style="color: #A0A0A0"> 124</span> <span style="color: #228B22; background: #FFFFFF;">		%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br/>               <span style="color: #A0A0A0"> 125</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 126</span> <span style="color: #228B22; background: #FFFFFF;">		% Let initVh and initVp be the "starter" covariance matrices</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 127</span> <span style="color: #000000; background: #FFFFFF;">		initVh=Vh; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 128</span> <span style="color: #000000; background: #FFFFFF;">		initVp=Vp; </span><br/>               <span style="color: #A0A0A0"> 129</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 130</span> <span style="color: #228B22; background: #FFFFFF;">		% Compute tau</span><br/>               <span style="color: #A0A0A0"> 131</span> <span style="color: #228B22; background: #FFFFFF;">		% tau = tau_i + tau_j where tau_i equals the node to tip distance</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 132</span> <span style="color: #000000; background: #FFFFFF;">		tau1=diag(initVh)*ones(1,length(initVh)) ... </span><br/>               <span style="color: #A0A0A0"> 133</span> <span style="color: #000000; background: #FFFFFF;">			+ ones(length(initVh),1)*diag(initVh)'-2*initVh;</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 134</span> <span style="color: #000000; background: #FFFFFF;">		tau2=diag(initVp)*ones(1,length(initVp)) ... </span><br/>               <span style="color: #A0A0A0"> 135</span> <span style="color: #000000; background: #FFFFFF;">			+ ones(length(initVp),1)*diag(initVp)'-2*initVp;</span><br/>               <span style="color: #A0A0A0"> 136</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 137</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 138</span> <span style="color: #228B22; background: #FFFFFF;">		% Numerically find the minimum MSE starting from guess of d in guessd </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 139</span> <span style="color: #000000; background: #FFFFFF;">		options=<a href="file7.html">optimset</a>('MaxFunEvals',10^4); </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 140</span> <span style="color: #000000; background: #FFFFFF;">		guessd=[.5 .5]; </span><br/>               <span style="color: #A0A0A0"> 141</span> <span style="color: #228B22; background: #FFFFFF;">		</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 142</span> <span style="color: #000000; background: #FFFFFF;">		d1=abs(guessd(1)); </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 143</span> <span style="color: #000000; background: #FFFFFF;">		d2=abs(guessd(2)); </span><br/>               <span style="color: #A0A0A0"> 144</span> <span style="color: #228B22; background: #FFFFFF;">			</span><br/>               <span style="color: #A0A0A0"> 145</span> <span style="color: #228B22; background: #FFFFFF;">		% calculate the covariance matrices under the OU process (eq A.1)</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 146</span> <span style="color: #000000; background: #FFFFFF;">        Vh=(d1.^tau1).*(1-d1.^(2*initVh))./(1-d1^2); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 147</span> <span style="color: #000000; background: #FFFFFF;">        Vp=(d2.^tau2).*(1-d2.^(2*initVp))./(1-d2^2); </span><br/>               <span style="color: #A0A0A0"> 148</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 149</span> <span style="color: #228B22; background: #FFFFFF;">        % standardize the covariance matrices to have determinant = 1 (this avoids</span><br/>               <span style="color: #A0A0A0"> 150</span> <span style="color: #228B22; background: #FFFFFF;">		% numerical issues of determinants going to infinity or zero)</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 151</span> <span style="color: #000000; background: #FFFFFF;">		Vh=Vh./det(Vh)^(1/p); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 152</span> <span style="color: #000000; background: #FFFFFF;">		Vp=Vp./det(Vp)^(1/q); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 153</span> <span style="color: #000000; background: #FFFFFF;">		V=<a href="file1.html">kron</a>(Vp,Vh); </span><br/>               <span style="color: #A0A0A0"> 154</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 155</span> <span style="color: #000000; background: #FFFFFF;">		invV=V\eye(n);    </span><br/>               <span style="color: #A0A0A0"> 156</span> <span style="color: #228B22; background: #FFFFFF;">		%%%size_invV_above=size(invV)</span><br/>               <span style="color: #A0A0A0"> 157</span> <span style="color: #228B22; background: #FFFFFF;">		</span><br/><span style="color: #FF0000">  0.09 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 158</span> <a name="Line158"></a><span style="color: #000000; background: #FFFFFF;">		[est MSE]=<a href="file18.html">fminsearch</a>('IGfunct',guessd,options); </span><br/>               <span style="color: #A0A0A0"> 159</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line160"></a>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 160</span> <span style="color: #000000; background: #FFFFFF;">		MSEs=[MSE MSEStar MSEbase] </span><br/>               <span style="color: #A0A0A0"> 161</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 162</span> <span style="color: #000000; background: #FFFFFF;">		d1=abs(est(1)); </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 163</span> <span style="color: #000000; background: #FFFFFF;">		d2=abs(est(2)); </span><br/><a name="Line164"></a>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 164</span> <span style="color: #000000; background: #FFFFFF;">		d1_d2=[d1 d2] </span><br/>               <span style="color: #A0A0A0"> 165</span> <span style="color: #228B22; background: #FFFFFF;">	</span><br/>               <span style="color: #A0A0A0"> 166</span> <span style="color: #228B22; background: #FFFFFF;">		%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br/>               <span style="color: #A0A0A0"> 167</span> <span style="color: #228B22; background: #FFFFFF;">		% Bootstrap</span><br/>               <span style="color: #A0A0A0"> 168</span> <span style="color: #228B22; background: #FFFFFF;">		%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br/>               <span style="color: #A0A0A0"> 169</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 170</span> <span style="color: #A0A0A0; background: #FFFFFF;">		if 1,</span><br/>               <span style="color: #A0A0A0"> 171</span> <span style="color: #228B22; background: #FFFFFF;">			</span><br/>               <span style="color: #A0A0A0"> 172</span> <span style="color: #228B22; background: #FFFFFF;">			%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br/>               <span style="color: #A0A0A0"> 173</span> <span style="color: #228B22; background: #FFFFFF;">			% Create bootstrap data set</span><br/>               <span style="color: #A0A0A0"> 174</span> <span style="color: #228B22; background: #FFFFFF;">			</span><br/>               <span style="color: #A0A0A0"> 175</span> <span style="color: #228B22; background: #FFFFFF;">			% Set the "true" values of X and d</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 176</span> <span style="color: #000000; background: #FFFFFF;">			Xtrue=X; </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 177</span> <span style="color: #000000; background: #FFFFFF;">			dtrue=[d1 d2]; </span><br/>               <span style="color: #A0A0A0"> 178</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 179</span> <span style="color: #228B22; background: #FFFFFF;">			% Compute covariance matrices with d1 and d2</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 180</span> <span style="color: #000000; background: #FFFFFF;">			Vh=(d1.^tau1).*(1-d1.^(2*initVh))./(1-d1^2); </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 181</span> <span style="color: #000000; background: #FFFFFF;">			Vp=(d2.^tau2).*(1-d2.^(2*initVp))./(1-d2^2); </span><br/>               <span style="color: #A0A0A0"> 182</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 183</span> <span style="color: #228B22; background: #FFFFFF;">			% Compute the "true" value of V</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 184</span> <span style="color: #000000; background: #FFFFFF;">			Vh=Vh./det(Vh)^(1/p); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 185</span> <span style="color: #000000; background: #FFFFFF;">			Vp=Vp./det(Vp)^(1/q); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 186</span> <span style="color: #000000; background: #FFFFFF;">			Vtrue=<a href="file1.html">kron</a>(Vp,Vh); </span><br/>               <span style="color: #A0A0A0"> 187</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 188</span> <span style="color: #228B22; background: #FFFFFF;">			% Compute the "true" value of b</span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 189</span> <span style="color: #000000; background: #FFFFFF;">			invV=Vtrue\eye(n); </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 190</span> <span style="color: #000000; background: #FFFFFF;">			btrue=(U'*invV*U)\(U'*invV*Xtrue); </span><br/>               <span style="color: #A0A0A0"> 191</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 192</span> <span style="color: #228B22; background: #FFFFFF;">			% Create the matrix T such that T*V*T' = I (identity matrix)</span><br/><span style="color: #FF0000">  0.11 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 193</span> <a name="Line193"></a><span style="color: #000000; background: #FFFFFF;">			[L D]=eig(Vtrue); </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 194</span> <span style="color: #000000; background: #FFFFFF;">			iD=diag(diag(D).^(-1/2),0); </span><br/>               <span style="color: #A0A0A0"> 195</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 196</span> <span style="color: #228B22; background: #FFFFFF;">			% Construct Y = T*X so that </span><br/>               <span style="color: #A0A0A0"> 197</span> <span style="color: #228B22; background: #FFFFFF;">			% E{(Y-b)*(Y-b)'} = E{(T*X-b)*(T*X-b)'}</span><br/>               <span style="color: #A0A0A0"> 198</span> <span style="color: #228B22; background: #FFFFFF;">			%				  = T*V*T'</span><br/>               <span style="color: #A0A0A0"> 199</span> <span style="color: #228B22; background: #FFFFFF;">			%				  = I</span><br/>               <span style="color: #A0A0A0"> 200</span> <span style="color: #228B22; background: #FFFFFF;">			</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 201</span> <span style="color: #000000; background: #FFFFFF;">			T=iD*L'; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 202</span> <span style="color: #000000; background: #FFFFFF;">			Y=T*Xtrue; </span><br/>               <span style="color: #A0A0A0"> 203</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 204</span> <span style="color: #228B22; background: #FFFFFF;">			% Residuals in orthogonalized space</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 205</span> <span style="color: #000000; background: #FFFFFF;">			resid=Y-btrue;	 </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 206</span> <span style="color: #000000; background: #FFFFFF;">			invT=T\eye(n); </span><br/>               <span style="color: #A0A0A0"> 207</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 208</span> <span style="color: #228B22; background: #FFFFFF;">			% Number of bootstrap replicates (2000 recommended for 95%</span><br/>               <span style="color: #A0A0A0"> 209</span> <span style="color: #228B22; background: #FFFFFF;">			% confidence intervals)</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 210</span> <span style="color: #000000; background: #FFFFFF;">			reps=2000;	 </span><br/>               <span style="color: #A0A0A0"> 211</span> <span style="color: #228B22; background: #FFFFFF;">			</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 212</span> <span style="color: #000000; background: #FFFFFF;">			bootlist=zeros(reps,3); </span><br/>               <span style="color: #A0A0A0"> 213</span> <span style="color: #228B22; background: #FFFFFF;">			</span><br/>               <span style="color: #A0A0A0"> 214</span> <span style="color: #228B22; background: #FFFFFF;">			% Estimate d for the bootstrap data set</span><br/><a name="Line215"></a>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 215</span> <span style="color: #000000; background: #FFFFFF;">			guessd=dtrue + [0 .1] </span><br/>               <span style="color: #A0A0A0"> 216</span> <span style="color: #228B22; background: #FFFFFF;">			</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 217</span> <span style="color: #000000; background: #FFFFFF;">			d1=abs(guessd(1)); </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 218</span> <span style="color: #000000; background: #FFFFFF;">			d2=abs(guessd(2)); </span><br/>               <span style="color: #A0A0A0"> 219</span> <span style="color: #228B22; background: #FFFFFF;">			</span><br/>               <span style="color: #A0A0A0"> 220</span> <span style="color: #228B22; background: #FFFFFF;">			% calculate the covariance matrices under the OU process (eq A.1)</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 221</span> <span style="color: #000000; background: #FFFFFF;">            Vh=(d1.^tau1).*(1-d1.^(2*initVh))./(1-d1^2); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 222</span> <span style="color: #000000; background: #FFFFFF;">            Vp=(d2.^tau2).*(1-d2.^(2*initVp))./(1-d2^2); </span><br/>               <span style="color: #A0A0A0"> 223</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 224</span> <span style="color: #228B22; background: #FFFFFF;">            % standardize the covariance matrices to have determinant = 1 (this avoids</span><br/>               <span style="color: #A0A0A0"> 225</span> <span style="color: #228B22; background: #FFFFFF;">			% numerical issues of determinants going to infinity or zero)</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 226</span> <span style="color: #000000; background: #FFFFFF;">			Vh=Vh./det(Vh)^(1/p); </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 227</span> <span style="color: #000000; background: #FFFFFF;">			Vp=Vp./det(Vp)^(1/q); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 228</span> <span style="color: #000000; background: #FFFFFF;">			V=<a href="file1.html">kron</a>(Vp,Vh); </span><br/>               <span style="color: #A0A0A0"> 229</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 230</span> <span style="color: #000000; background: #FFFFFF;">			invV=V\eye(n);                        %this takes a long time </span><br/>               <span style="color: #A0A0A0"> 231</span> <span style="color: #228B22; background: #FFFFFF;">			%Vg=gpuArray(V);                        %push V to gpu memory</span><br/>               <span style="color: #A0A0A0"> 232</span> <span style="color: #228B22; background: #FFFFFF;">			%Ig=parallel.gpu.GPUArray.eye(n);       %create identity matrix on gpu</span><br/>               <span style="color: #A0A0A0"> 233</span> <span style="color: #228B22; background: #FFFFFF;">			%invVg=Vg\Ig;                           %try this instead</span><br/>               <span style="color: #A0A0A0"> 234</span> <span style="color: #228B22; background: #FFFFFF;">			%invV=gather(invVg);                    %push back to cpu</span><br/>               <span style="color: #A0A0A0"> 235</span> <span style="color: #228B22; background: #FFFFFF;">			</span><br/><span style="color: #FF0000"> 67.29 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 236</span> <a name="Line236"></a><span style="color: #000000; background: #FF8080;">			parfor i = 1:reps    % what the hell.. give it a shot </span><br/>               <span style="color: #A0A0A0"> 237</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 238</span> <span style="color: #228B22; background: #FFFFFF;">				% vector of random indices</span><br/><a name="Line239"></a>               <span style="color: #A0A0A0"> 239</span> <span style="color: #A0A0A0; background: #FFFFFF;">				randindex=ceil(n*rand(n,1));	</span><br/>               <span style="color: #A0A0A0"> 240</span> <span style="color: #228B22; background: #FFFFFF;">				</span><br/>               <span style="color: #A0A0A0"> 241</span> <span style="color: #228B22; background: #FFFFFF;">				% create new values of Y selecting residuals at random with</span><br/>               <span style="color: #A0A0A0"> 242</span> <span style="color: #228B22; background: #FFFFFF;">				% replacement</span><br/><a name="Line243"></a>               <span style="color: #A0A0A0"> 243</span> <span style="color: #A0A0A0; background: #FFFFFF;">				YY=btrue+resid(randindex);	</span><br/>               <span style="color: #A0A0A0"> 244</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 245</span> <span style="color: #228B22; background: #FFFFFF;">				% back-transformed data to create boostrap data set X</span><br/><a name="Line246"></a>               <span style="color: #A0A0A0"> 246</span> <span style="color: #A0A0A0; background: #FFFFFF;">				X=invT*YY;	</span><br/>               <span style="color: #A0A0A0"> 247</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 248</span> <span style="color: #A0A0A0; background: #FFFFFF;">				[est MSE]=fminsearch('IGfunct',guessd,options);</span><br/>               <span style="color: #A0A0A0"> 249</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 250</span> <span style="color: #228B22; background: #FFFFFF;">				% Collect estimates and MSE into bootlist</span><br/>               <span style="color: #A0A0A0"> 251</span> <span style="color: #A0A0A0; background: #FFFFFF;">				bootlist(i,:)=[abs(est) MSE];</span><br/>               <span style="color: #A0A0A0"> 252</span> <span style="color: #228B22; background: #FFFFFF;">				</span><br/>               <span style="color: #A0A0A0"> 253</span> <span style="color: #A0A0A0; background: #FFFFFF;">			end</span><br/>               <span style="color: #A0A0A0"> 254</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 255</span> <span style="color: #228B22; background: #FFFFFF;">			% Calculate confidence intervals</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 256</span> <span style="color: #000000; background: #FFFFFF;">			alpha=0.05; </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 257</span> <span style="color: #000000; background: #FFFFFF;">			conf=[]; </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 258</span> <span style="color: #000000; background: #FFFFFF;">			for i=1:2, </span><br/>       <span style="color: #0000FF">      8 </span><span style="color: #000000; font-weight: bold"> 259</span> <span style="color: #000000; background: #FFFFFF;">				bootlistsorted=sort(bootlist(:,i)); </span><br/>       <span style="color: #0000FF">      8 </span><span style="color: #000000; font-weight: bold"> 260</span> <span style="color: #000000; background: #FFFFFF;">				lower_boot=bootlistsorted(floor(0.5*alpha*length(bootlist))); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      8 </span><span style="color: #000000; font-weight: bold"> 261</span> <span style="color: #000000; background: #FFFFFF;">				mean_boot=<a href="file60.html">mean</a>(bootlist(:,i)); </span><br/>       <span style="color: #0000FF">      8 </span><span style="color: #000000; font-weight: bold"> 262</span> <span style="color: #000000; background: #FFFFFF;">				upper_boot=bootlistsorted(ceil((1-0.5*alpha)*length(bootlist))); </span><br/><a name="Line263"></a><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      8 </span><span style="color: #000000; font-weight: bold"> 263</span> <span style="color: #000000; background: #FFFFFF;">				conf=[conf; lower_boot mean_boot upper_boot]; </span><br/>       <span style="color: #0000FF">      8 </span><span style="color: #000000; font-weight: bold"> 264</span> <span style="color: #000000; background: #FFFFFF;">			end </span><br/>               <span style="color: #A0A0A0"> 265</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 266</span> <span style="color: #228B22; background: #FFFFFF;">			% Print data</span><br/><a name="Line267"></a>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 267</span> <span style="color: #000000; background: #FFFFFF;">			lowerconf_mean_upperconf_d=conf </span><br/>               <span style="color: #A0A0A0"> 268</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line269"></a>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 269</span> <span style="color: #000000; background: #FFFFFF;">			min_d=min(bootlist) </span><br/><a name="Line270"></a>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 270</span> <span style="color: #000000; background: #FFFFFF;">			max_d=max(bootlist) </span><br/><a name="Line271"></a><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 271</span> <span style="color: #000000; background: #FFFFFF;">			cor_d=<a href="file61.html">corrcoef</a>(bootlist) </span><br/>               <span style="color: #A0A0A0"> 272</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 273</span> <span style="color: #228B22; background: #FFFFFF;">			% Plot bootstrap parameter estimates</span><br/><span style="color: #FF0000">  0.15 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 274</span> <a name="Line274"></a><span style="color: #000000; background: #FFFFFF;">			figure(2*(aflag-1)+(Vhflag-1)+1) </span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 275</span> <span style="color: #000000; background: #FFFFFF;">			for ii=1:2, </span><br/>       <span style="color: #0000FF">      8 </span><span style="color: #000000; font-weight: bold"> 276</span> <span style="color: #000000; background: #FFFFFF;">				for jj=ii:2, </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">     12 </span><span style="color: #000000; font-weight: bold"> 277</span> <span style="color: #000000; background: #FFFFFF;">					<a href="file67.html">subplot</a>(2,2,2*(ii-1)+jj) </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">     12 </span><span style="color: #000000; font-weight: bold"> 278</span> <span style="color: #000000; background: #FFFFFF;">					plot(bootlist(:,ii),bootlist(:,jj),'o',... </span><br/>               <span style="color: #A0A0A0"> 279</span> <span style="color: #000000; background: #FFFFFF;">						dtrue(ii),dtrue(jj),'x')</span><br/>       <span style="color: #0000FF">     12 </span><span style="color: #000000; font-weight: bold"> 280</span> <span style="color: #000000; background: #FFFFFF;">				end </span><br/>       <span style="color: #0000FF">      8 </span><span style="color: #000000; font-weight: bold"> 281</span> <span style="color: #000000; background: #FFFFFF;">			end </span><br/><span style="color: #FF0000">  0.17 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 282</span> <a name="Line282"></a><span style="color: #000000; background: #FFFFFF;">			pause(.1) </span><br/>               <span style="color: #A0A0A0"> 283</span> <span style="color: #A0A0A0; background: #FFFFFF;">		end</span><br/>       <span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 284</span> <span style="color: #000000; background: #FFFFFF;">	end </span><br/>       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"> 285</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/></pre></body></html>